---
title: 毕设23 - 毕业论文的草稿
categories: [笔记]
tags: [毕设, 智能合约, TrustZone]
date: 2025-05-01
---

最后一篇，毕业论文的草稿，写完了回去贴到 overleaf 里。

<!--more-->

题目：基于 TrustZone 的元宇宙分布式数字身份系统研究与实现



重点是实现分布式数字身份。为了解决隐私问题，引入了 TrustZone 。但是 TrustZone 和智能合约难以结合，又开发了一个基于 TrustZone 的 Wasm 智能合约模块。Wasm 用于降低开发难度。该模块也不仅限于使用在DID场景里，也可以用于开发其他的诸如匿名投票等合约。



# 摘要

随着区块链与数字身份技术的发展，用户对隐私保护与可信身份验证提出了更高要求。传统智能合约在执行过程中公开所有输入与状态，难以满足敏感身份信息处理的隐私需求。本文提出了一种基于 ARM TrustZone 与 WebAssembly 的轻量级智能合约执行架构，通过将合约逻辑与数据处理隔离至可信执行环境，实现了对用户隐私的硬件级保护。该架构集成 Wasm 运行时，降低了隐私合约的开发门槛，并设计了基于共享内存与扩展 WASI 接口的高效跨域通信机制。

在此基础上，本文构建了一个支持加密可验证凭证（VC）校验的分布式数字身份系统。该系统结合 ECDH 密钥协商与 AES 对称加密，实现了无需暴露明文信息的零知识属性验证机制，适用于资源受限的移动与边缘环境。为验证系统的可用性，本文以虚拟电影院为应用场景，展示了用户在不泄露真实年龄的前提下完成购票与验票流程的全过程。

实验结果表明，本系统在 TrustZone 环境下的合约执行性能保持在可接受范围内，DID 注册、VC 校验等关键操作均可实现秒级响应，验证了在移动设备中部署隐私增强型智能合约的可行性与实用性。





随着区块链与数字身份技术的发展，越来越多的应用对链上计算提出了更高的隐私保护与可信执行要求。传统智能合约在执行过程中公开全部输入、状态与逻辑，难以满足处理敏感身份信息或隐私数据的实际需求。为此，本文提出了一种基于 ARM TrustZone 与 WebAssembly（Wasm）的轻量级智能合约执行架构。该系统将合约逻辑与数据处理隔离于 TrustZone 安全世界中，提供硬件级隐私保护，并集成 Wasm 运行时以降低隐私合约的开发复杂度。为实现链上请求与受限环境间的高效交互，本文设计了基于共享内存与扩展 WASI 接口的高性能通信机制。

在此基础上，本文实现了一个支持加密形式下可验证凭证（VC）校验的分布式数字身份（DID）系统，结合 ECDH 密钥交换与 AES 对称加密，实现无需明文暴露的零知识属性验证机制，适用于资源受限的移动与边缘计算环境。为展示系统的应用能力，本文进一步设计并实现了一个虚拟电影院原型系统，用户可在不泄露真实年龄等敏感信息的前提下完成去中心化身份注册、购票与验票流程。

实验评估表明，尽管引入 TrustZone 带来一定性能开销，系统在 DID 注册、VC 验证、链上交易等操作中仍保持了良好的延迟与吞吐表现。研究结果验证了在移动终端与边缘设备中部署隐私增强型智能合约系统的可行性与实用性，为构建可信、隐私友好的链上应用提供了一种可行解决方案。

# 1 引言

## 1.1 研究背景与意义

> - 元宇宙中数字身份的关键作用
> - 数字身份隐私保护的重要性与现有问题
>

随着数字化服务的日益发展，用户在数字世界中的身份管理和隐私保护问题成为亟待解决的挑战。然而，当前大多数身份系统仍依赖于中心化平台进行身份托管与认证，存在隐私泄露风险大、可移植性差、用户控制权缺失等问题。用户的身份数据通常掌握在平台方手中，无法真正实现“自我主权身份”的愿景。

分布式数字身份（Decentralized Identity, DID）技术的兴起为解决上述问题提供了新的方向。它允许用户拥有并控制自己的身份标识和凭证，消除了对中心化身份提供者的依赖。但与此同时，如何在分布式架构下实现高效、安全、可验证的隐私保护机制仍面临重大挑战。**[分布式数字身份及其在工业互联网中的应用]**

与此同时，区块链作为一种可验证、不可篡改的分布式账本技术，在构建身份基础设施方面展现出独特优势。然而，传统区块链智能合约的完全公开执行模型导致用户输入、合约逻辑及运行状态全部暴露在链上，给涉及敏感数据的应用（如身份验证、医疗记录、隐私投票等）带来了严重的隐私泄露风险。因此，如何在保障用户隐私的同时，确保链上身份认证和凭证验证的可验证性，已成为区块链系统设计中的关键难题。

为兼顾隐私保护与可验证性，本课题引入了基于 ARM TrustZone 的可信执行环境（Trusted Execution Environment, TEE），通过硬件隔离机制将敏感身份数据与认证逻辑部署于安全世界执行，避免在链上暴露敏感信息，从而构建轻量级、可信任、去中心化的数字身份系统。同时，为降低合约开发门槛、提升跨平台适应性，系统采用 WebAssembly (Wasm) 作为智能合约执行格式，进一步支持用户在终端设备上安全高效地运行身份相关合约。本研究不仅提升了用户身份的安全保障，也为资源受限终端设备部署隐私增强型区块链应用提供了可行路径，具有重要的理论意义与现实价值。



## 1.2 现有数字身份技术与隐私保护方法

### 1.2.1 数字身份技术的演变

> 中心化数字身份、联盟身份到分布式数字身份的演变。（可以增加引用了）
>

随着信息化与网络服务的快速发展，用户身份的数字化表示与管理方式经历了从中心化身份（Centralized Identity）到联盟身份（Federated Identity），再到分布式数字身份的逐步演变，每一阶段均试图在用户体验、隐私保护与系统可扩展性之间寻找更优平衡。

在早期阶段，中心化身份模型广泛应用于各类互联网平台。该模型由单一身份提供方（Identity Provider, IdP）负责用户信息的存储与验证，典型代表如谷歌账户、苹果 ID 等。这种模式部署简单、认证效率高，但用户需将全部身份数据托付于中心平台，一旦平台遭受攻击或发生泄露，将造成严重的隐私与信任风险。研究表明，该模型在数据主权、隐私控制与系统弹性方面存在天然缺陷 [A Comparative Survey of Centralised and Decentralised Identity Management Systems: Analysing Scalability, Security, and Feasibility]。

为提升身份跨域互操作性，联盟身份模型应运而生。它允许多个独立组织之间通过建立信任联盟共享身份认证信息，使用户可在多个系统间“单点登录”而无需重复注册或验证。该模式显著改善了用户体验与认证效率，常见标准包括 SAML、OAuth 2.0 和 OpenID Connect。然而，联盟身份仍依赖中心化信任锚（如特定 IdP 或认证服务器），在隐私泄露防护与用户主权控制方面仍显不足 [A Survey on Federated Identity Management Systems: Limitations and Solutions.” Journal of Network and Computer Applications]。此外，不同组织间信任协同的成本也限制了其可扩展性 

近年来，分布式数字身份作为新一代身份管理范式逐渐兴起。它基于区块链等分布式账本技术（DLT），将身份标识的生成、管理与验证权力归还给用户自身，强调“自我主权身份（Self-Sovereign Identity, SSI）”理念。在该模型下，用户拥有并控制自己的公私钥、DID 文档与可验证凭证（VC），实现对个人身份数据的最小披露与可控共享。该模式在提升隐私性、安全性与可移植性的同时，也面临认证逻辑下沉、资源受限设备支持等实际落地难题 [Survey on Digital Sovereignty and Identity: From Digitization to Digitalization.]。。



### 1.2.2 分布式数字身份中的隐私保护

> 零知识证明。zk-SNARK、zk-STARK。基于默克尔树的选择性披露。
>

在分布式数字身份系统中，隐私保护始终是一个重要的问题。相比传统身份认证方式，DID 虽然消除了对中心化身份提供者的依赖，但也带来了新的挑战：如何让用户在不泄露完整身份信息的前提下，向验证方证明其满足某些属性要求（如“已满18岁”、“为某机构注册用户”等）。

为解决这一问题，选择性披露技术应运而生。该机制允许用户仅披露某一条或少数几条经授权的信息，而无需暴露整个凭证内容，从而实现最小化数据暴露。较为常见的一种实现方式是基于 默克尔树构造凭证结构，用户仅需提交特定字段的哈希路径，即可证明其身份数据在原凭证中确实存在，兼顾完整性验证与隐私保护 [Selective disclosure of claims from multiple digital credentials]。



另一个重要方向是 零知识证明（Zero-Knowledge Proof, ZKP）。ZKP 是一类密码学协议，允许证明者向验证者证明某一声明为真，却无需透露任何除该声明之外的额外信息 [The knowledge complexity of interactive proof-systems]。ZKP 技术为分布式身份系统的隐私验证提供了强有力支撑，当前已有多种主流方案。

- **zk-SNARK（Zero-Knowledge Succinct Non-Interactive Argument of Knowledge）**[A Survey on the Applications of Zero-Knowledge Proofs] 是目前应用最广泛的一类零知识证明系统，具备证明体积小、验证速度快等优点，已被 Zcash、Tornado Cash 等项目用于实现匿名交易。其缺点在于依赖“可信设定”（Trusted Setup），一旦初始密钥泄露，系统安全性将面临严重风险；同时，其开发门槛较高，需要将计算逻辑转换为电路或约束系统，证明生成开销大，难以适配移动设备或边缘环境。
- **zk-STARK（Scalable Transparent ARguments of Knowledge）** [Scalable, transparent, and post-quantum secure computational integrity]则通过使用哈希函数代替传统代数结构，避免了可信设定问题，并具备抗量子攻击能力，适用于大规模验证任务。该方案已被应用于 StarkNet、zkML 等高性能区块链项目中。但其证明生成过程对硬件资源要求高，难以在低功耗终端中高效部署。



尽管 zk 系统在安全性与隐私保护方面具备强大优势，但其计算负担重、开发复杂度高、对运行环境要求高等问题，使其难以直接应用于资源受限设备。



相比之下，本文提出的身份系统采取了不同策略：将身份验证与凭证校验逻辑放置于 ARM TrustZone 构建的可信执行环境中，借助硬件隔离实现隐私保护。在本系统中，用户使用 **ECDH** 协议与合约共享密钥，使用 **AES** 对称加密凭证后提交，可信执行环境内部执行解密与属性判断，从而实现一种零知识证明机制，并天然支持选择性披露、属性范围证明、多凭证聚合验证等功能。该方案不依赖复杂电路转换与可信设定，部署门槛低，性能稳定，尤其适合于移动终端与边缘计算等低资源场景。	



## 1.3 TrustZone与智能合约结合的相关工作

> 照搬related work
>
> - TrustZone 简介与隐私保护优势
> - 相关工作
>     - TZ4Fabric
>     - WaTZ
>     - 有研究表明 TrustZone 的信道测攻击
>

随着区块链对隐私保护与可信执行能力的需求不断提升，硬件可信执行环境逐渐成为保护合约执行安全的可行方案。其中，Arm TrustZone 是一种被广泛使用的 TEE 技术。它通过将处理器划分为“安全世界（Secure World）”与“普通世界（Normal World）”，为敏感数据和计算逻辑提供了物理隔离的执行空间 [TrustZone Explained: Architectural Features and Use Cases]。与 Intel SGX 等其他 TEE 技术相比，TrustZone 更适用于移动设备和边缘终端，具备部署成本低、功耗小等优势。

已有部分研究尝试将 TrustZone 与区块链智能合约结合，以实现隐私增强的链上计算。

- TZ4Fabric 是首个将 TrustZone 应用于 Fabric 区块链的系统 [TZ4Fabric: Executing Smart Contracts with ARM TrustZone : (Practical Experience Report)]。该方案将 Fabric 的链码执行逻辑转化为 TrustZone 中运行的可信应用程序 （Trusted Application, TA），实现了链码的硬件隔离保护。然而，该设计存在两个主要问题：（1）每个链码需手动实现一个独立的 TA，需以状态机方式细化合约流程，导致复杂合约难以维护；（2）用户部署新合约时需修改节点代码、更新中间代理模块并重启 TrustZone 服务，实际操作繁琐，难以满足区块链系统的可扩展性需求。

- WaTZ 提出了一种将 WebAssembly Micro Runtime（WAMR）移植至 TrustZone 的方法，并实现了远程认证机制 [WaTZ: A Trusted WebAssembly Runtime Environment with Remote Attestation for TrustZone]。该工作表明在 TEE 中嵌入通用 Wasm 运行时是可行的，为后续将 Wasm 作为合约执行环境的系统奠定了基础。基于此思路，本文进一步构建了一个可动态加载 Wasm 合约的 TrustZone 执行模块，实现了智能合约的即时部署与安全执行，提升了系统的开发友好性与可移植性。

尽管 TrustZone 提供了强隔离能力，其安全性也面临一定威胁。已有研究表明，TrustZone 中的安全存储可能受到侧信道攻击与权限提升攻击的威胁 [Hardware-Backed Heist: Extracting ECDSA Keys from Qualcomm's TrustZone]。这些问题涉及 TrustZone 平台底层的安全机制实现，超出了本课题的讨论范围，但在未来构建更强隐私保障系统时仍值得深入研究。



## 1.4 本文所做的工作

> - 提出一种基于 TrustZone 和 Wasm 的智能合约执行架构，实现合约逻辑在 TEE 中的安全执行与链上状态交互。
> - 提出一种结合共享密钥协商与对称加密的“零知识式”验证机制，替代传统 ZK 方法，适用于资源受限设备。
> - 设计并实现一个轻量级分布式数字身份系统，支持 VC 的加密提交与可信验证，保护用户隐私。并实现了一个元宇宙电影院场景验证该系统的可用性。
> - 本文的研究内容与组织结构安排
>

针对当前数字身份系统中普遍存在的隐私泄露、可信度不足以及难以在资源受限设备中部署等问题，本文围绕“在可信执行环境中实现隐私增强型分布式数字身份系统”的目标展开研究，主要完成了以下工作：

1. **提出一种基于 TrustZone 和 Wasm 的智能合约执行架构**。该架构将智能合约的执行环境迁移至 TrustZone 安全世界，利用 WebAssembly 运行时实现合约逻辑的轻量化部署与安全执行，并通过共享内存与扩展 WASI 接口，实现与区块链节点的状态交互与通信，兼顾隐私保护与系统可扩展性。
2. **设计一种结合共享密钥协商与对称加密的零知识式验证机制**。用户通过 ECDH 协议生成共享密钥，将身份凭证加密后提交，由 TEE 内部完成解密与条件判断，实现无需电路建模、无需可信设定的“轻量级零知识证明”，可部署于移动终端等资源受限场景中。
3. **实现一个轻量级的分布式数字身份系统**。支持 DID 注册、VC 发放与 VC 验证等核心功能，并确保身份数据全生命周期中的隐私与安全。进一步，本文构建了一个**元宇宙虚拟电影院场景**，展示该系统在典型应用环境中的可用性与通用性，验证了系统架构与身份验证流程的实用价值。
4. **完成系统实现与功能测试**。在 QEMU v8 虚拟平台中完成区块链节点与 TrustZone 合约执行环境的搭建，分别开展智能合约模块的性能测试、分布式数字身份系统的功能性验证，以及应用场景的交互流程测试，全面评估系统的稳定性与实际可用性。

本论文的章节结构如下：

- 第2章为**理论基础部分**，介绍分布式数字身份、区块链与智能合约、TrustZone 架构与 Wasm 技术、相关密码学原语；
- 第3章为**系统设计与实现**，分别阐述基于TrustZone的Wasm合约模块、分布式身份系统的工作流程及一个元宇宙应用示例；
- 第4章为**实验与测试**，在虚拟化环境中对系统各模块进行性能与功能验证；
- 第5章总结全文，并展望未来的扩展方向。



# 2 理论部分

## 2.1 分布式数字身份

> - 去中心化数字身份（DID）与可验证凭证（VC）
>

分布式数字身份（Decentralized Identity, DID）是一种自我主权、去中心化的身份管理方式。它允许用户无需依赖传统的中心化身份服务提供者，即可拥有并控制自己的身份标识与相关凭证。每个 DID 通常对应一对用户持有的加密密钥，用于实现身份的认证、授权与数据完整性保护，具备全局唯一性、可验证性与隐私性等特征。W3C（万维网联盟）制定了相关标准，规范了 DID 的结构、解析方法及其关联文档的表达格式。DID 由三部分组成：固定前缀“did”、方法标识符（指示该 DID 采用的解析方案）和唯一标识符（用以标识用户实体）。

每一个 DID 对应一份 分布式身份文档（DID Document），用于记录与该 DID 相关的公钥、服务端点（Service Endpoint）、验证方法等信息。这些文档通常存储于公开可验证的分布式账本上，支持任意实体通过 DID 进行信息查验，从而确保身份数据的完整性与可验证性。[DIDs]

与 DID 配套使用的可验证凭证（Verifiable Credential, VC）是一种结构化数字证书，由权威发行方对某个用户属性（如姓名、年龄、学历等）进行签名背书，支持在多个主体之间安全、可信地交换身份信息。一个典型的 VC 体系包括三类参与者：发行者（Issuer）、持有者（Holder）与验证者（Verifier）。其中，发行者对凭证进行签名，持有者负责存储和管理，验证者则通过加密方式验证凭证的真实性与完整性，无需直接联系发行者即可完成验证，从而有效保障了用户隐私。

## 2.2 区块链与智能合约

> - 区块链、智能合约
>

区块链（Blockchain） 是一种去中心化的分布式账本技术，最初作为比特币的底层数据结构提出，近年来已广泛应用于金融、溯源、数字身份等多个领域。区块链通过共识机制确保网络中各节点对账本状态达成一致，并通过密码学手段实现数据的不可篡改与可追溯性。每个区块中包含一组交易记录，并通过哈希函数与前一个区块相连接，从而形成链式结构，保障整个账本的完整性与安全性 \cite{Bitcoin: A Peer-to-Peer Electronic Cash System}。与传统分布式数据库不同，区块链系统无需信任中心即可实现去信任化协作。其核心特性包括去中心化、防篡改、高可用与透明性，使其成为构建可信计算环境的重要技术基础。

智能合约（Smart Contract） 是部署在区块链上的自动化程序，用于根据预设规则执行协议内容。由 Nick Szabo 于 1994 年首次提出，其核心思想是将合约逻辑以代码形式固化在分布式账本中，合约一旦部署即不可随意更改，并将在满足特定触发条件时自动执行 \cite{Smart Contract Development: Challenges and Opportunities}。当前主流区块链平台如 Ethereum、Polkadot、Cosmos 等均提供了支持智能合约的运行机制。在智能合约执行过程中，用户通过提交交易触发合约函数调用，链上节点对合约代码进行解释或编译执行，并将执行结果和状态变更记录在区块中。由于执行过程和结果完全公开且不可篡改，智能合约被广泛应用于去中心化金融（DeFi）、链上治理、供应链管理和数字身份系统等场景中。



## 2.3 Arm TrustZone

> - TrustZone 架构与 OP-TEE 实现
> - TEE 对隐私保护的优势与常见应用
>

Arm TrustZone 是 Arm 处理器架构中的一项硬件级安全扩展技术，其核心思想是在单一物理处理器中划分出两个隔离的执行环境：安全世界（Secure World） 与 普通世界（Normal World），以此实现对敏感数据和关键任务的硬件隔离保护 \cite{ngabonzizaTrustZoneExplainedArchitectural2016a}。当系统运行在普通世界时，无法访问安全世界的资源；而安全世界则具备完整的系统访问权限，可用于处理安全相关的逻辑，如密码学运算、密钥管理、用户身份认证等。

这一隔离机制由硬件中的 安全监控器（Secure Monitor） 进行管理，任务在两个世界之间的切换通过 安全监控调用（SMC）指令 实现，确保了可信计算过程不被普通世界中的潜在恶意软件干扰。

为支持在 TrustZone 平台上开发与运行可信应用，Arm 官方主导并维护了开源项目 OP-TEE（Open Portable Trusted Execution Environment） \cite{OPTEE}。OP-TEE 遵循 GlobalPlatform \cite{GlobalPlatform} 标准接口，整体架构包括：

- **OP-TEE OS**：运行在安全世界的 TEE 核心，负责加载和调度受信任应用（Trusted Applications，TA）；
- **OP-TEE Client**：运行在普通世界的用户态库与内核驱动，用于发起 TEE 服务调用；
- **GlobalPlatform API**：提供标准的开发接口与系统调用规范，便于跨平台移植与系统集成。

通过 OP-TEE，开发者可以为特定业务逻辑（如支付指令、密钥生成与签名、用户认证等）开发 TA，并部署于受硬件保护的安全世界中运行，从而实现可信计算。

在隐私保护领域，TEE 的主要优势包括：

- **计算过程私密性强**：外部系统无法窥探 TEE 内部的指令执行过程与数据状态；
- **数据加解密安全性高**：密钥及加解密过程始终保留在 TEE 内部，不易被提取；

基于以上优势，TEE 技术已广泛应用于移动支付、数字身份认证、数字版权管理（DRM）、医疗数据保护等场景。在区块链系统中，将智能合约的隐私计算部分迁移至 TrustZone 中执行，有助于弥补传统链上合约在数据隐私与执行可控性方面的缺陷，成为构建“链下可信执行+链上可验证”架构的重要支撑技术。



## 2.4 WebAssembly

> - WebAssembly 技术简介与优势
> - Wasm 在区块链与智能合约中的应用现状（CosmWasm、Polkadot，无法将合约执行环境移植到TEE中）

WebAssembly（Wasm）是一种轻量级的二进制指令格式，最初由 W3C 提出，用于在 Web 浏览器中高效、安全地运行代码 \cite{haasBringingWebSpeed2017a}。开发者可以使用 C、C++、Rust 等高级语言编写程序，并将其编译为 Wasm 模块，实现跨平台、近原生性能的代码执行。Wasm 具备启动快、体积小、沙箱隔离、安全性强等特点，现已广泛应用于边缘计算、物联网等资源受限场景。

在区块链领域，Wasm 逐渐被用于替代传统虚拟机执行智能合约。Cosmos 生态中的 CosmWasm 模块与 Polkadot 平台的 ink! 均引入了基于 Wasm 的合约机制，实现了更高的语言灵活性和跨平台能力。然而，这些平台普遍依赖 Rust 标准库，合约执行环境复杂，无法直接部署在受限的 TEE 中；同时，如 Polkadot 等平台本身架构较重，不适用于轻量化部署需求。\cite{CosmWasm/cosmwasm} \cite{use-ink/ink}

因此，本文采用 Wasm Micro Runtime（WAMR）等轻量运行时，将合约执行模块迁移至 TrustZone 安全世界。该方案不仅简化了合约开发与部署流程，也为资源受限环境中的可信智能合约执行提供了可行路径。



## 2.5 密码学基础原语

> - 对称加密：AES
> - 密钥协商：ECDH
> - 数字签名：ECDSA

本系统在设计中引入多种基础密码学原语，主要包括对称加密算法 AES、椭圆曲线密钥协商协议 ECDH 以及数字签名算法 ECDSA，分别用于保护敏感数据、建立安全通信通道以及验证身份与数据完整性。

### 2.5.1 对称加密算法：AES

高级加密标准（Advanced Encryption Standard，AES）是一种广泛应用的分组对称加密算法，被美国国家标准与技术研究院（NIST）采纳为联邦加密标准 \cite{The Design of Rijndael}。AES 使用固定长度的 128 位分组进行加密，支持 128、192 和 256 位的密钥长度，在本系统中使用 AES-256 模式进行 VC（可验证凭证）加密。

AES 的基本加密过程包括多个轮次的替代（SubBytes）、行移位（ShiftRows）、列混淆（MixColumns）和轮密钥加（AddRoundKey）等操作，其数学基础是有限域 GF(2⁸) 上的代数运算。形式上，对于明文 $P$、密钥 $K$，加密输出为：

$$
C = \text{AES}_{K}(P)
$$

其中 $C$ 表示密文，仅持有密钥 $K$ 方可解密恢复原始数据。



### 2.5.2 密钥协商协议：ECDH

椭圆曲线 Diffie-Hellman（Elliptic Curve Diffie-Hellman，ECDH）是一种基于椭圆曲线密码学的密钥交换协议，可在不安全信道中协商出共享密钥 \cite{Elliptic curve cryptosystems}。其安全性基于椭圆曲线离散对数难题。

具体而言，通信双方分别拥有密钥对 $(d_A, P_A = d_A G)$ 和 $(d_B, P_B = d_B G)$，其中 $G$ 是椭圆曲线上的生成元，$d$ 为私钥，$P$ 为对应的公钥。共享密钥计算如下：


$$
K_{\text{shared}} = d_A P_B = d_A d_B G = d_B P_A
$$

该共享密钥可用于后续对称加密通信，在本系统中用于加密 VC 内容，实现端到端隐私保护。



### 2.5.3 数字签名算法：ECDSA

椭圆曲线数字签名算法（Elliptic Curve Digital Signature Algorithm，ECDSA）是一种基于椭圆曲线的数字签名机制，广泛用于身份认证与数据完整性验证 \cite{The Elliptic Curve Digital Signature Algorithm (ECDSA)}。其过程包括签名生成和签名验证两部分。

设待签名消息为 $m$，用户私钥为 $d$，公钥为 $P = dG$，签名过程为：

1. 选取随机数 $k$，计算 $R = kG$，取 $r = R_x \bmod n$；
2. 计算 $s = k^{-1}(H(m) + dr) \bmod n$；
3. 签名为对 $(r, s)$ 的组合。

验证方根据公钥 $P$、消息 $m$ 和签名 $(r, s)$ 计算：

1. $w = s^{-1} \bmod n$；
2. $u_1 = H(m) w$, $u_2 = r w$；
3. $X = u_1 G + u_2 P$，验证 $X_x \bmod n = r$ 是否成立。

ECDSA 在本系统中用于用户身份的认证挑战与凭证签名验证，确保身份声明未被篡改且确实由对应 DID 所属者生成。



# 3 系统设计与实现

本章提出一种基于 TrustZone 的智能合约执行架构，将合约逻辑与敏感数据处理隔离至安全世界，通过共享内存与扩展接口实现合约调用与链上状态的交互。该架构集成了 Wasm 运行时，降低了开发门槛，并内置加密原语以支持隐私合约开发。在此基础上，本文设计并实现了一个分布式数字身份系统，支持DID注册、VC发放与加密VC验证，验证过程实现零知识证明。在应用层面，本文进一步构建了一个虚拟电影院场景：用户可向可信机构申请 VC 作为年龄凭证，并在不暴露具体年龄信息的前提下，向电影院证明其已年满法定观影年龄。



## 3.1 基于TrustZone的Wasm智能合约模块

本系统基于 TrustZone 提出了一种轻量级的智能合约执行架构，如图 \ref{fig:system_architecture} 所示。系统整体分为两个核心组成部分：一是基于 Cosmos SDK \cite{CosmosCosmossdk2025, kwonCosmosWhitepaper2020} 搭建的区块链节点，负责合约生命周期管理及链上状态维护；二是部署于 TrustZone 安全世界的智能合约执行模块，负责执行合约逻辑与处理敏感数据。两者通过共享内存与扩展接口实现安全协同。

```
\begin{figure}[h]
\centering
\includegraphics[width=1.1\textwidth]{figure/系统架构图.pdf}
\caption{基于 TrustZone 与 Wasm 的智能合约系统架构}
\label{fig:system_architecture}
\end{figure}
```

### 3.1.1 智能合约管理模块

> 智能合约管理模块（链上）设计与实现

本系统基于 Cosmos SDK 框架构建区块链节点，并在此基础上设计并实现了一个专用于 Wasm智能合约生命周期管理的自定义模块。该模块负责协调合约的上传、实例化、调用与状态查询等核心操作，同时作为链上世界与 TrustZone 安全世界之间的通信桥梁，支持智能合约请求的可信执行。

该模块主要包含以下四类功能：

（1）**合约上传**：用户通过交易提交已预编译为 AOT（Ahead-of-Time）格式的 Wasm 字节码。相较于传统的解释执行方式，AOT 格式合约在部署前完成静态机器码生成，具有启动速度快、执行效率高的优势。链上模块在接收字节码后会为合约生成唯一标识，并将其持久化存储于链上状态中；

（2）**合约实例化**：用户可通过交易请求对某个已上传的字节码合约进行初始化，并传入初始化参数。系统将在链上为其创建一个新的合约账户，并调用合约中定义的 instantiate 函数完成状态初始化；

（3）**合约调用**：用户可提交交易调用已部署的合约函数。系统保证每个合约实例在状态上彼此隔离，合约之间无法直接访问他人状态，确保逻辑封装性和执行安全性；

（4）**状态查询**：用户可调用合约中的只读函数查询当前状态信息。与交易调用不同，状态查询为同步操作，直接从链上状态存储中读取数据并返回结果。

在与 TrustZone 的协作过程中，该模块还承担了重要的执行中继职责。具体而言，区块链节点会将用户提交的合约调用请求进行格式转换与权限校验，并构造执行参数通过安全通道传入部署于安全世界（TEE）中的 Trusted Application（TA）。在实现上，我们将 TA host 侧的通信逻辑封装为标准化的 C 语言库，并通过 cgo 接口集成至基于 Go 实现的区块链模块中，使得主链逻辑能够以统一、透明的方式完成对 TEE 的调用。

在合约执行完成后，TA 会将结果以结构化数据的形式返回至普通世界，由链上模块解析返回值并根据合约逻辑进行状态更新。为确保整个执行流程的一致性与事务完整性，该模块与 Tendermint 共识机制深度集成，所有涉及状态变更的交易需经过共识确认后才会正式生效，从而确保了系统的可验证性与可信性。



### 3.1.2 智能合约执行模块

> 智能合约执行模块（TEE内）设计与实现
>
> 跨环境通信机制设计（共享内存与扩展WASI接口）

为了适应 TrustZone 受限的执行环境，本系统选用轻量级的 Wasm 运行时 —— Wasm Micro Runtime（WAMR） \cite{bytecodealliance/wasm-micro-runtime} 作为合约执行引擎。WAMR 具有低内存占用、快速启动等特点，适用于资源受限的 TEE 场景。本系统在 TrustZone 中部署 WAMR 的方式借鉴了 WaTZ 的设计思路 \cite{menetreyWaTZTrustedWebAssembly2022}，并对其进行了精简与定制，使其能在 OP-TEE 上高效加载并运行 AOT 编译格式的 Wasm 合约。

合约执行过程中需访问链上状态，而 TEE 无法直接操作区块链节点的存储空间。为此，我们设计了一种基于 共享内存与扩展 WASI 接口 的通信机制。具体而言，在 REE 与 TEE 之间分配一段共享内存，区块链节点进程被划分为两个线程：主线程通过 TEEC_InvokeCommand 向 TEE 发起合约执行请求，副线程负责监听共享内存中的数据访问请求。当 TEE 中的合约通过扩展的 WASI 接口发起状态读取或修改操作时，会向共享内存写入结构化请求，REE 侧捕捉到该请求后，从链状态中完成对应的数据读取或写入，并将结果写回共享内存，由 TEE 获取返回结果继续执行。

该共享机制配合一个跨语言的通信库协同实现：我们将 Go 实现的状态访问逻辑封装为 C 可调用的函数指针，并通过回调注入到 TA host 端，从而实现了跨世界、跨语言的高效状态访问路径。该设计支持按上下文与合约地址精确映射到对应存储空间，具备良好的可扩展性与安全边界控制能力。

为支持隐私合约与链上可信交互，TEE 内部集成了一套轻量级的加密原语，包括基于 ECDH 的共享密钥协商、基于 AES 的对称加解密、以及基于 ECDSA 的数字签名功能。在区块链节点部署前，系统将一个用于密钥交换的私钥写入 TEE 内部的安全存储中，供后续加密通信使用。该私钥受到硬件隔离保护，外部无法访问或导出。智能合约通过扩展 WASI 接口即可便捷调用上述加密操作，从而实现包括身份认证、加密验证在内的多种隐私保护计算任务。

## 3.2 分布式数字身份系统

本系统基于上文所述的基于 TrustZone 和 Wasm 的智能合约执行架构，实现了一个支持集成化身份注册、凭证发放与加密凭证验证的分布式数字身份系统，应用于私人身份信息隐私保护场景下的可信校验。系统主要包括三类角色：用户（User）、凭证发行者（Issuer）和校验者（Verifier），其中合约逻辑由链上 DID 智能合约执行。



### 3.2.1 数字身份注册

在系统中，用户需在本地生成两对非对称密钥对：一对用于身份认证中的数字签名，另一对用于与合约之间的密钥交换。所有密钥均基于椭圆曲线 prime256v1（即 NIST P-256）生成，兼具安全性与较好的计算性能，适用于移动端和嵌入式设备 \cite{brownSEC2Recommended, brownSoftwareImplementationNIST2001}。

用户将这两对密钥中的公钥提交至链上的 DID 智能合约进行注册。合约在接收到公钥后，会生成一份 DID 文档，其中包含用户的签名公钥和密钥交换公钥，并将该文档持久化存储在链上状态中，供后续身份验证和凭证校验使用。注册成功后，合约将返回一个唯一的 DID 标识符（Decentralized Identifier），用于在系统中标识用户身份，绑定其链上操作与相关凭证。

### 3.2.2 可验证凭证发放

在 VC 的颁发阶段，凭证发行者（Issuer）通常为具有公信力的权威机构，如政府、学校或金融服务机构。系统默认该发行者已具备对用户真实身份的审核能力，而发行者获取用户真实身份信息的过程并非本系统关注的范畴。发行流程开始时，发行者向用户发送一次性挑战（challenge），用于确认用户对 DID 的所有权。用户使用其本地持有的签名私钥对挑战进行签名，并将签名结果返回。发行者随后从链上读取用户的 DID 文档，提取公钥验证签名的合法性，以此确认请求者与链上注册身份的一致性。身份确认完成后，发行者根据其掌握的用户信息生成一份 VC，内容可能包括用户的姓名、年龄、住址等身份属性。该 VC 在生成后直接交付给用户本地存储，而不会上链或公开发布。

### 3.2.3 加密凭证验证

为保障用户身份凭证的隐私性，同时支持验证方对关键属性的可信校验，本系统设计了一种零知识证明验证方法。该流程使得验证者能够在不知晓 VC 明文内容的前提下，判断用户是否满足某个属性条件（例如“年龄 ≥ 18”）。

验证过程包括如下步骤：

1. **共享密钥协商与 VC 加密**：用户使用自己的密钥交换私钥与部署时写入 TEE 的公钥执行 ECDH 协议，协商出一组对称加密密钥。随后，用户使用该共享密钥对其本地存储的 VC 内容进行 AES 加密，并将密文发送给验证者。
2. **身份验证**：验证者向用户发送一次性挑战，用户使用其签名私钥进行签名并返回。验证者从链上读取 DID 文档，验证签名以确认其 DID 所有权。
3. **验证请求提交**：验证者将接收到的加密 VC 与用户 DID 一并提交至链上 DID 智能合约模块，发起 VC 验证请求。
4. **TEE 内部解密与校验**：区块链节点接收到请求后，将调用合约执行模块。系统通过 TEE 中存储的私钥与用户 DID 文档中的公钥执行 ECDH 协议，重构共享密钥。随后使用该密钥解密 VC，并验证 VC 中记录的 DID 与请求用户是否匹配，若一致则进一步判断指定属性（如年龄）是否满足验证条件。
5. **返回验证结果**：TA 将验证结果（通过 / 拒绝）返回给验证者。整个过程中，验证者始终无法获取 VC 的明文内容，也无法从交互中反推出用户的真实身份属性。

上述验证流程如图 \ref{fig:workflow} 所示。

```
\begin{figure}[h] \centering \vspace*{-0.5cm} \includegraphics[width=1.1\textwidth]{figure/时序图.pdf} \caption{VC 验证流程示意图} \label{fig:workflow} \end{figure}
```

该流程在无需构建复杂电路或生成加密证明的前提下，实现了零知识性质的属性验证，尤其适用于移动端、IoT 等受限环境下的轻量级隐私计算场景。



## 3.3 元宇宙应用示例：虚拟电影院场景实现

### 3.3.1 总体系统架构

> 该系统分为四个主要模块：
>
> 1. 区块链网络，用于执行智能合约、存储用户的数字身份文档
> 2. 电影院服务，提供浏览电影、购票、检票等服务
> 3. 公安局服务，用于给用户提供出生证明。该系统中只有公安局唯一一个权威的 VC 发行机构
> 4. 前端网页（客户端），用户在这里管理本地秘钥，向电影院、公安局、区块链发送各种请求。

为验证所设计的分布式数字身份系统在实际场景中的可用性，本文构建了一个基于元宇宙虚拟空间的“虚拟电影院”应用。该系统围绕用户年龄验证展开身份认证与权限控制，确保用户在不暴露具体年龄的前提下，实现对成人观影内容的合规访问。

系统整体架构如图所示，主要由以下四个功能模块构成：

1. **区块链网络**

    该模块基于 Cosmos SDK 搭建，并集成了本文提出的智能合约管理与执行模块。其主要职责包括：接受用户注册的 DID 公钥对，生成并存储 DID 文档；响应来自电影院或公安局发起的智能合约请求；协调与 TEE 中合约执行模块的交互，完成 VC 的加密验证等功能。

2. **电影院服务**

    电影院作为用户访问的应用服务端，提供观影内容浏览、购票下单、检票入场等功能。在检票环节，电影院系统需调用 DID 合约对用户提交的加密 VC 进行验证，判断其是否满足“已成年”的属性条件。

3. **公安局服务**

    公安局是本系统中唯一的 VC 发行机构，具有为用户签发年龄凭证的权威性。用户需通过签名验证向公安局证明其 DID 所属身份，在完成身份核实后，公安局根据用户真实年龄生成 VC，返回给用户本地保存。VC 内容不会上链，也不会泄露至第三方。

4. **前端网页（客户端）**

    用户通过前端网页进行所有交互操作，包括 DID 注册、凭证申请、购票下单与 VC 提交等。前端本地管理用户生成的签名密钥对和密钥交换密钥对，支持在客户端执行对 VC 的 AES 加密和签名操作。前端亦承担构造请求并向各模块（区块链、公安局、电影院）发送交互消息的职责，是用户与系统交互的核心入口。

该架构通过模块化设计实现身份认证与业务逻辑的解耦，并利用区块链与 TEE 提供的可信执行能力，保障了用户身份数据的隐私性与验证过程的安全性。在不泄露敏感信息的前提下，用户仍可完成“是否成年”的零知识验证，体现了系统在实际场景下的工程适用性与隐私保护能力。

### 3.3.2 数据结构设计

这一小节将介绍系统中的数据结构设计。所有数据结构均在符合 W3C 标准的前提下进行了一些简化。

DID 标志符

DID 文档

VC 





# 4 实验与测试

## 4.1 实验环境搭建与配置

> - 论文中的 智能合约执行环境
> - Node Express，Vue3 的电影院场景环境

以下是中文毕业设计文档中 **第4章 实验与测试** 的第一个小节：



------





## **4 实验与测试**







### **4.1 实验环境搭建与配置**

本系统的实验测试工作在 Ubuntu 22.04 操作系统上完成，使用 QEMU v8.1.2 构建 ARMv8 虚拟化平台，支持 ARM TrustZone 安全执行模式。TEE 执行环境基于 OP-TEE v4.3.0 版本，QEMU 配置为双核处理器、1GB 内存，并启用了 secure=on 参数以开启安全世界的模拟支持。

所有交易与查询请求均通过 Cosmos SDK 提供的 RPC 接口完成，采用 REST 协议发送 JSON 格式的消息。在客户端模拟方面，宿主机运行基于 JavaScript 编写的脚本，用于模拟多个客户端发起并发请求。在实验设置中，客户端并发数从 1 逐步增加至 32，每组配置下运行 5 分钟，记录全过程的交易延迟与吞吐率。

本节的性能测试主要包含两部分内容：（1）评估 Wasm 合约在 TEE 与 REE 中执行性能的差异，测试对象为轻量级计数器合约，用以衡量硬件隔离机制所引入的性能开销；（2）测试 DID 系统中的关键功能模块在 TEE 内的平均延迟，包括 DID 注册、DID 文档查询以及 VC 验证，验证系统在实际身份隐私保护任务中的处理能力。

为进一步分析 TrustZone 架构对合约执行性能的影响，本文引入两项相对性能变化指标用于与 TZ4Fabric 系统的间接对比。考虑到两系统在区块链平台、合约执行模型与硬件部署环境方面存在较大差异，直接比较原始延迟与吞吐率数据并不公平。因此，本研究采用以下两个指标：

- **吞吐率下降率（Throughput Degradation Rate, TDR）**

    \text{TDR} = \frac{T_{\text{REE}} - T_{\text{TEE}}}{T_{\text{REE}}}

- **延迟提升率（Latency Increase Rate, LIR）**

    \text{LIR} = \frac{L_{\text{TEE}} - L_{\text{REE}}}{L_{\text{REE}}}

    其中 $T_{\text{REE}}$ 与 $T_{\text{TEE}}$ 分别表示在 REE 与 TEE 中的吞吐率，$L_{\text{REE}}$ 与 $L_{\text{TEE}}$ 表示相应的平均延迟。

此外，为测试系统在完整业务场景下的可用性与稳定性，本文进一步搭建了一个 **虚拟电影院** 场景应用平台。该平台主要包含：

- **后端服务**：基于 Node.js + Express 框架实现，提供电影信息展示、购票下单、检票验证、凭证颁发等功能。
- **前端页面**：使用 Vue3 框架构建，提供用户身份注册、凭证管理、购票流程交互与验证请求发起等界面。



## 4.2 智能合约模块性能测试与分析

> 照搬论文。

本节对基于 TrustZone 的智能合约执行模块在两类核心操作下的性能开销进行评估：状态查询（query）与交易提交（transaction）。

在 Cosmos SDK 的运行模型中，交易操作（tx）在每个区块生成前以批处理形式统一执行，平均出块间隔约为 3 秒，吞吐率受限于区块大小与出块频率。而状态查询操作不会修改链上状态，允许节点实时响应，具有更强的并发处理能力。因此，我们分别测量两类操作在不同并发负载下的吞吐率与平均响应延迟，并对比 TEE 与 REE 两种执行环境下的结果。

实验过程中我们发现，无论合约逻辑如何，首次在 TEE 中发起调用均需通过 \verb|TEEC_OpenSession| 建立安全会话，该操作为每笔交易引入显著的性能开销。该现象与 TZ4Fabric 的实验结果一致 \cite{mullerTZ4FabricExecutingSmart2020}。为降低开销，我们在系统中对 \verb|TEEC_Context| 与 \verb|TEEC_Session| 进行全局缓存，避免频繁创建会话带来的冗余损耗。



```
\begin{figure}[h]

\centering

% \hspace*{-0.1\textwidth}

\includegraphics[width=1\textwidth]{figure/performance.pdf}

\caption{不同并发数下 REE 与 TEE 环境中状态查询与交易提交的延迟与吞吐率对比}

\label{fig:query-tx-performance}

\end{figure}
```



如图 \ref{fig:query-tx-performance} 所示，实验结果主要包括以下两点观察：



```
\begin{enumerate}

\item **查询操作**方面，TEE 环境下的平均延迟始终是 REE 的两倍以上，吞吐率稳定在约 11 QPS，为 REE 的约 47%。由于 TEE 中存在上下文切换、共享内存通信和 TA 调度等额外开销，整体性能有所下降。



\item **交易操作**方面，在并发数较低时，TEE 所引入的性能影响相对较小，吞吐率与 REE 接近，延迟略有增加。然而并发数上升后，交易处理出现积压，部分请求需延迟至后续区块执行，导致平均延迟增加。最终，TEE 模式下交易吞吐率趋于稳定，略低于 REE。

\end{enumerate}
```



```
\begin{table}[t]

\centering

\caption{TEE 引入的性能影响：与 TZ4Fabric 系统对比}

\label{tab:TDR_LIR_Table}

\renewcommand{\arraystretch}{1.15}

\setlength{\tabcolsep}{6pt}



\begin{subtable}[t]{0.46\linewidth}

\centering

\caption{状态查询（Query）}

\label{tab:query_variation}

\begin{tabular}{c cc cc}

\toprule

\multirow{2}{*}{\textbf{并发数}} &*

*\multicolumn{2}{c}{\textbf{TDR}} &*

*\multicolumn{2}{c}{\textbf{LIR}} \*

*\cmidrule(lr){2-3}\cmidrule(lr){4-5}*

*& TZ & 本文 & TZ & 本文 \*

*\midrule*

*1 & 0.50 & 0.27 & 1.63 & 0.67 \*

*2 & 0.59 & 0.33 & 1.70 & 0.79 \*

*4 & 0.59 & 0.46 & 1.52 & 1.15 \*

*8 & 0.61 & 0.51 & 1.75 & 1.20 \*

*16 & 0.67 & 0.54 & 3.18 & 1.30 \*

*32 & 0.79 & 0.53 & 4.92 & 1.20 \*

*\bottomrule*

*\end{tabular}*

*\end{subtable}*

*\hfill*

*\begin{subtable}[t]{0.46\linewidth}*

*\centering*

*\caption{交易提交（Transaction）}*

*\label{tab:tx_variation}*

*\begin{tabular}{c cc cc}*

*\toprule*

*\multirow{2}{*}{\textbf{并发数}} &

\multicolumn{2}{c}{\textbf{TDR}} &

\multicolumn{2}{c}{\textbf{LIR}} \

\cmidrule(lr){2-3}\cmidrule(lr){4-5}

& TZ & 本文 & TZ & 本文 \

\midrule

1 & 0.46 & 0.01 & 1.48 & 0.01 \

2 & 0.62 & 0.04 & 1.48 & 0.05 \

4 & 0.61 & 0.05 & 1.54 & 0.04 \

8 & 0.61 & 0.07 & 1.88 & 0.07 \

16 & 0.68 & 0.24 & 3.46 & 0.33 \

32 & 0.79 & 0.45 & 5.11 & 0.87 \

\bottomrule

\end{tabular}

\end{subtable}

\end{table}

```



从表 \ref{tab:TDR_LIR_Table} 可以看出，相较于 TZ4Fabric 系统，本文提出的架构在查询与交易场景下均表现出更低的性能损耗，尤其是在交易提交操作中，TEE 所带来的延迟提升与吞吐下降更为平缓，表明本系统在性能与隐私保护之间取得了更优的平衡。



## 4.3 分布式数字身份系统功能测试

> 照搬论文

```
为评估系统在典型使用场景下对分布式数字身份（DID）相关功能的处理能力，我们对 DID 注册、DID 文档查询 与 VC 验证 三个核心操作进行了性能测试。在资源受限环境下，每项操作均以单线程模式连续执行 200 次，并记录其平均响应时间，以评估系统在单个用户请求下的响应效率。

表 \ref{tab:did_performance} 展示了上述三项操作的平均、最小与最大响应延迟：

\begin{table}[t]
\centering
\caption{DID 合约功能操作的延迟评估}
\label{tab:did_performance}
\renewcommand{\arraystretch}{1.15}
\setlength{\tabcolsep}{8pt}
\begin{tabular}{lccc}
\toprule
\textbf{功能模块} & \textbf{平均延迟（ms）} & \textbf{最小值（ms）} & \textbf{最大值（ms）} \
\midrule
Create DID  & 3059.91 & 3056.13 & 3100.83 \
Query DID   & 216.31  & 198.79  & 281.29  \
Verify VC   & 2119.69 & 1793.26 & 2318.74 \
\bottomrule
\end{tabular}
\end{table}

从测试结果可以看出，Query DID 的平均延迟约为 216 毫秒，是三项操作中响应最快的，反映出系统在链上状态读取方面具有良好的实时性，适用于高频身份信息检索。Create DID 的平均响应时间约为 3 秒，与区块链交易的打包与出块周期一致，延迟稳定，满足去中心化身份注册的功能需求。Verify VC 的平均响应时间约为 2.1 秒，虽高于前两项操作，但其过程包含对称加密解密与条件判断等计算步骤，在多数身份验证场景中仍属于可接受范围。

总体而言，测试结果表明该系统即便在 TrustZone 的受限执行环境中，也能保持良好的响应性能，核心功能均可实现秒级响应。特别是在移动终端与边缘计算等实际部署场景中，DID 查询与 VC 验证操作具备较强的实用性，有效验证了本架构在隐私保护与服务性能之间的可行平衡。
```



## 4.4 虚拟电影院应用场景测试

> 用户端交互界面流程展示，截图配文字。



# 5 结论与展望

## 5.1 结论

本文围绕“基于 TrustZone 的元宇宙分布式数字身份系统”展开研究，提出了一种面向资源受限设备的轻量级智能合约执行架构。该架构基于 ARM TrustZone 构建可信执行环境，并引入 WebAssembly 运行时以支持合约的灵活部署与执行。同时设计了一套高效的链上链下通信机制，支持 REE 与 TEE 之间的协同工作。

在此基础上，本文实现了一个分布式数字身份系统，支持去中心化的身份注册、可验证凭证的发放与加密校验。通过 ECDH 密钥协商与 AES 加密方式，系统实现了无需明文暴露的零知识式认证机制，满足了隐私保护与可验证性的双重需求。结合虚拟电影院场景的完整实现，系统展示了在现实业务中保护用户身份隐私的实际能力。

实验结果表明，该系统在保证隐私保护的同时，维持了良好的执行性能和响应能力，验证了将隐私增强型合约部署于 TrustZone 等低功耗终端设备的可行性。

## 5.2 展望

尽管本系统在隐私保护与工程实现方面取得了一定成果，仍有若干值得深入研究与优化的方向：

首先，当前系统默认 TrustZone 中的 TEE 环境完全可信，尚未涵盖针对侧信道攻击、特权升级等低层级威胁模型的防护机制。未来可引入远程证明（Remote Attestation）或执行完整性检测手段，增强系统在不完全可信执行环境下的安全鲁棒性。

其次，DID 模块目前支持基本的身份注册与 VC 验证，后续可扩展更多身份属性表达与组合校验能力，支持属性区间验证、多凭证联合验证等高级场景，提升系统在实际应用中的表达能力与灵活性。

在系统性能方面，仍可通过优化共享内存的读写策略与通信线程模型，进一步压缩 REE 与 TEE 间的上下文切换与数据传输开销，从而提升高并发条件下的系统响应效率。

此外，Wasm 智能合约模块可进一步集成更丰富的安全原语接口，如零知识证明构造、选择性披露、可撤销凭证等，以支持更复杂的隐私计算任务。

最后，结合 Cosmos 的 IBC 跨链通信协议，系统可进一步向多链环境拓展，为异构区块链平台提供统一的可信身份认证与隐私保护服务，构建更具通用性和可扩展性的分布式身份基础设施。







​	

Wasm 的核心优势包括：1）快速启动与高效执行，适用于对响应速度有严格要求的应用场景；2）跨平台兼容性强，得益于统一的中间格式和平台中立的运行时抽象；3）内存安全与沙箱隔离机制，通过线性内存模型、模块边界限制等手段，天然具备良好的安全性与可控性；4）模块化与可组合性强，支持模块导入导出机制，便于功能拆分与系统集成。
